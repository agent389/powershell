Get-Content web-hosts.txt | foreach {[System.Net.Dns]::GetHostbyAddress($_)} | Select -ExpandProperty HostName | foreach{Invoke-Command -ComputerName $_ {$dns=(get-wmiobject -class Win32_computerSystem).Name+'.'+(get-wmiobject -class Win32_computersystem).Domain; Import-Module webadministration; $p=get-webapplication|select -ExpandProperty path; foreach($s in $p){$dns+$s}}} |out-file websites.txt
